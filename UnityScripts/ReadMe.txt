This is not the most elegant code by far, nor is it the most efficient.
However it works and that's something to celebrate.
